<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Votaci√≥n Escolar</title>
    <link rel="icon" href="img/logo.png" type="image/png">
    <link rel="stylesheet" href="css/bulma.min.css">
    <link rel="stylesheet" href="css/sweetalert2.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/acta.css">
</head>
<body>

    <section class="hero is-info is-small no-print">
        <div class="hero-body">
            <div class="container has-text-centered header-logos">
                <div class="level">
                    <div class="level-item"><img src="img/logo.png" alt="Logo Empresa"></div>
                </div>
                <div class="level">
                    <div class="level-item"><img src="img/huila.png" alt="Escudo del Departamento del Huila"></div>
                    <div class="level-item">
                        <div>
                            <h1 class="title is-4">INSTITUCI√ìN EDUCATIVA PROMOCI√ìN SOCIAL</h1>
                            <h2 class="subtitle is-6">Sistema de Votaci√≥n Electr√≥nica</h2>
                        </div>
                    </div>
                    <div class="level-item"><img src="img/escudo.png" alt="Escudo de la Instituci√≥n Educativa"></div>
                </div>
            </div>
        </div>
    </section>

    <div class="container is-max-desktop p-4">
        
        <div class="level is-mobile no-print">
            <div class="level-left">
                <span id="infoMesa" class="tag is-info is-large is-hidden"></span>
            </div>
            <div class="level-right">
                <button id="btnAdmin" class="button is-warning is-small mr-2 is-hidden">‚öôÔ∏è Panel</button>
                
                                <button id="btnLogout" class="button is-danger is-outlined is-hidden">üö™ Salir</button>
            </div>
        </div>

        <section id="view-login" class="view-section">
            <div class="columns is-centered">
                <div class="column is-half">
                    <div class="card p-5">
                        <h3 class="title is-4 has-text-centered">Ingreso</h3>
                        <form id="formLogin">
                            <div class="field">
                                <label class="label" for="loginUser">Usuario</label>
                                <input class="input" id="loginUser" name="usuario" placeholder="Ej: mesa.1" required>
                            </div>
                            <div class="field">
                                <label class="label" for="loginPass">Contrase√±a</label>
                                <input class="input" id="loginPass" type="password" name="pass" placeholder="******" required>
                            </div>
                            <button type="submit" class="button is-info is-fullwidth">Ingresar</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-mode" class="view-section is-hidden has-text-centered">
            <h3 class="title is-4 mb-5">Seleccione el modo de este dispositivo</h3>
            <div class="columns is-centered">
                <div class="column is-5">
                    <div class="card p-5 card-action" id="btnModeJurado">
                        <p class="title is-1">üìã</p>
                        <h4 class="title is-5">JURADO</h4>
                        <p>Validar documentos y habilitar votantes.</p>
                    </div>
                </div>
                <div class="column is-5">
                    <div class="card p-5 card-action" id="btnModeUrna">
                        <p class="title is-1">üó≥Ô∏è</p>
                        <h4 class="title is-5">URNA DIGITAL</h4>
                        <p>Pantalla para que los estudiantes voten.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-jurado" class="view-section is-hidden">
            <div class="card p-6 has-text-centered">
                <h3 class="title is-4">Habilitar Votante</h3>
                <p class="mb-4">Ingrese el documento para desbloquear la Urna Digital.</p>
                <div class="field has-addons is-justify-content-center">
                    <div class="control">
                        <label class="is-sr-only" for="inputDocumento">Documento de Identidad</label>
                        <input class="input is-large" type="number" id="inputDocumento" placeholder="Documento" title="Ingrese documento del estudiante">
                    </div>
                    <div class="control"><button id="btnValidar" class="button is-success is-large">HABILITAR</button></div>
                </div>
            </div>
        </section>

        <section id="view-urna-espera" class="view-section is-hidden has-text-centered">
            <div class="box py-6 has-background-light">
                <div class="loader-wrapper mb-4">
                    <div class="loader is-loading loader-custom"></div>
                </div>
                <h2 class="title is-2 has-text-grey">URNA BLOQUEADA</h2>
                <h3 class="subtitle is-4">Por favor, ac√©rquese al Jurado.</h3>
                <p>Mesa #<span id="lblMesaEspera"></span></p>
            </div>
        </section>

        <section id="view-tarjeton" class="view-section is-hidden has-text-centered">
            <div class="notification is-primary is-light mb-4">
                Estudiante: <strong id="lblEstudianteVotando"></strong>
            </div>
            <h2 id="tituloCargo" class="title is-3 mb-5">Elecci√≥n</h2>
            <div id="contenedorCandidatos" class="columns is-multiline is-centered"></div>
        </section>

        <section id="view-admin" class="view-section is-hidden">
            <h2 class="title is-4 has-text-centered">Panel de Administraci√≥n</h2>
            <div class="columns is-multiline">
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" data-target="view-cargas"><p class="title is-1">üë•</p><p>Estudiantes</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" data-target="view-sedes"><p class="title is-1">üè´</p><p>Sedes y Grados</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" data-target="view-votos"><p class="title is-1">üì•</p><p>Cargar / Descargar Votos</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" data-target="view-config"><p class="title is-1">‚öôÔ∏è</p><p>Configuraci√≥n</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" data-target="view-candidatos"><p class="title is-1">üñºÔ∏è</p><p>Candidatos</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" data-target="view-acta"><p class="title is-1">üìÑ</p><p>Acta de Escrutinio</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" data-target="view-resultados"><p class="title is-1">üìä</p><p>Resultados en vivo</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" id="btnGenerarCarnets"><p class="title is-1">ü™™</p><p>Generar Carn√©s</p></div></div>
                <div class="column is-4"><div class="card p-4 has-text-centered card-action" id="btnResetSistema"><p class="title is-1">üßπ</p><p>Limpiar Sistema</p></div></div>
            </div>
        </section>

        <section id="view-cargas" class="view-section is-hidden">
            <button class="button is-small mb-4 btn-back-admin">‚Üê Volver</button>
            <div class="card p-5">
                <h3 class="title is-5">Cargar Estudiantes</h3>
                <button id="btnDescargarPlantilla" class="button is-link is-light mb-3">Descargar plantilla de carga masiva</button>
                <div class="field">
                    <label class="label" for="fileEstudiantes">Archivo Excel</label>
                    <div class="control">
                        <input class="input" type="file" id="fileEstudiantes" accept=".xlsx, .xls" title="Seleccionar archivo de estudiantes">
                    </div>
                </div>
                <button id="btnCargarEstudiantes" class="button is-success">Procesar</button>
                <div id="resumenEstudiantes" class="mt-4"></div>
            </div>
        </section>

        <section id="view-sedes" class="view-section is-hidden">
            <button class="button is-small mb-4 btn-back-admin">‚Üê Volver</button>
            <div class="columns">
                <div class="column is-6">
                    <div class="card p-4 mb-4">
                        <h4 class="title is-6">Nueva sede</h4>
                        <form id="formSede">
                            <input class="input mb-2" name="nombreSede" placeholder="Nombre sede" required>
                            <button class="button is-primary is-small" type="submit">Guardar sede</button>
                        </form>
                    </div>
                    <div class="card p-4">
                        <h4 class="title is-6">Nuevo grado por sede</h4>
                        <form id="formGrado">
                            <div class="select is-fullwidth mb-2"><select id="sedeGrado" name="sede_id" title="Seleccionar sede para el grado" aria-label="Seleccionar sede"></select></div>
                            <input class="input mb-2" name="nombreGrado" placeholder="Ej: 5A" required>
                            <button class="button is-link is-small" type="submit">Guardar grado</button>
                        </form>
                    </div>
                </div>
                <div class="column is-6">
                    <div class="card p-4">
                        <h4 class="title is-6">Sedes y grados configurados</h4>
                        <ul id="listaSedesGrados"></ul>
                        <div id="boxAsignacionMasiva" class="mt-4"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-votos" class="view-section is-hidden">
            <button class="button is-small mb-4 btn-back-admin">‚Üê Volver</button>
            <div class="columns">
                <div class="column is-6">
                    <div class="card p-4">
                        <h4 class="title is-6">Consolidado general</h4>
                        <button id="btnExportarConsolidado" class="button is-info is-small mr-2">Descargar consolidado Excel</button>
                        <button id="btnPlantillaVotos" class="button is-link is-light is-small">Descargar plantilla votos</button>
                    </div>
                </div>
                <div class="column is-6">
                    <div class="card p-4">
                        <h4 class="title is-6">Cargar votos consolidados</h4>
                        <label for="fileVotos" class="is-sr-only">Archivo de votos consolidados</label>
<input id="fileVotos" type="file" class="input mb-2" accept=".xlsx,.xls" title="Seleccionar archivo de votos">
                        <button id="btnImportarVotos" class="button is-success is-small">Importar votos</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-config" class="view-section is-hidden">
            <button class="button is-small mb-4 btn-back-admin">‚Üê Volver</button>
            <div class="card p-5">
                <h3 class="title is-5">Configuraci√≥n</h3>
                <form id="formConfig">
                    <div class="columns is-multiline">
                        <div class="column is-6"><label class="label" for="confRector">Rector(a)</label><input id="confRector" class="input" name="rector"></div>
                        <div class="column is-6"><label class="label" for="confLider">L√≠der Proyecto</label><input id="confLider" class="input" name="lider"></div>
                        <div class="column is-6"><label class="label" for="confLugar">Lugar</label><input id="confLugar" class="input" name="lugar"></div>
                        <div class="column is-6"><label class="label" for="confFecha">Fecha</label><input id="confFecha" class="input" name="fecha" type="date"></div>
                        <div class="column is-6"><label class="label" for="confInicio">Hora Inicio</label><input id="confInicio" class="input" name="hora_inicio" type="time"></div>
                        <div class="column is-6"><label class="label" for="confFin">Hora Fin</label><input id="confFin" class="input" name="hora_fin" type="time"></div>
                        <div class="column is-6">
                            <label class="label" for="fileFirmaRector">Firma Rector (PNG/SVG)</label>
                            <input id="fileFirmaRector" class="input" name="firma_rector" type="file" accept=".png,.svg" title="Subir firma del rector">
                        </div>
                        <div class="column is-6">
                            <label class="label" for="fileFirmaLider">Firma L√≠der (PNG/SVG)</label>
                            <input id="fileFirmaLider" class="input" name="firma_lider" type="file" accept=".png,.svg" title="Subir firma del l√≠der">
                        </div>
                        <div class="column is-6"><img id="firmaRectorActual" class="firma-preview" alt="Firma actual del rector"></div>
                        <div class="column is-6"><img id="firmaLiderActual" class="firma-preview" alt="Firma actual del l√≠der"></div>
                    </div>
                    <button type="submit" class="button is-primary">Guardar</button>
                    <button id="btnCerrarMesas" type="button" class="button is-danger ml-2">Cerrar mesas</button>
                    <button id="btnAbrirMesas" type="button" class="button is-success ml-2">Abrir mesas</button>
                </form>
            </div>
        </section>

        <section id="view-candidatos" class="view-section is-hidden">
            <button class="button is-small mb-4 btn-back-admin">‚Üê Volver</button>
            <div class="columns">
                <div class="column is-4">
                    <div class="card p-4">
                        <h4 class="title is-6">Nuevo Candidato</h4>
                        <form id="formCandidato">
                            <div class="field">
                                <label class="label" for="candNombre">Nombre</label>
                                <input id="candNombre" class="input mb-2" name="nombre" placeholder="Nombre completo" required>
                            </div>
                            <div class="field">
                                <label class="label" for="candCargo">Cargo</label>
                                <div class="select is-fullwidth mb-2">
                                    <select id="candCargo" name="cargo" title="Seleccionar Cargo">
                                        <option value="Personero">Personero</option>
                                        <option value="Contralor">Contralor</option>
                                    </select>
                                </div>
                            </div>
                            <div class="field">
                                <label class="label" for="candFoto">Fotograf√≠a</label>
                                <input id="candFoto" class="input mb-2" type="file" name="foto" required title="Subir foto del candidato">
                            </div>
                            <button type="submit" class="button is-link is-fullwidth">Agregar</button>
                        </form>
                    </div>
                </div>
                <div class="column is-8">
                    <table class="table is-fullwidth is-striped" aria-label="Lista de Candidatos">
                        <thead><tr><th>Foto</th><th>Nombre</th><th>Cargo</th><th>Acci√≥n</th></tr></thead>
                        <tbody id="tablaCandidatos"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="view-acta" class="view-section is-hidden">
            <button class="button is-small mb-4 btn-back-admin no-print">‚Üê Volver</button>
            <button id="btnDescargarPDF" class="button is-small is-danger mb-4 no-print">üìÑ Descargar PDF</button>
            
            <div id="contenidoActa" class="acta-container has-background-white p-6">
                </div>
        </section>

        <section id="view-resultados" class="view-section is-hidden">
            <button class="button is-small mb-4 btn-back-admin">‚Üê Volver</button>
            <div class="card p-4">
                <h3 class="title is-5">Resultados en vivo (0.5s)</h3>
                <div class="columns">
                    <div class="column"><h4 class="subtitle is-6">Personero</h4><div id="chartPersonero"></div></div>
                    <div class="column"><h4 class="subtitle is-6">Contralor</h4><div id="chartContralor"></div></div>
                </div>
            </div>
        </section>

    </div>

    <footer class="has-text-centered p-4 mt-6">¬© 2026 Rafael Mauricio P√©rez Campos - Ingeniero de Sistemas</footer>

    <script src="js/lib/sweetalert2.all.min.js"></script>
    <script src="js/lib/html2pdf.bundle.min.js"></script>
    <script type="module" src="js/app.js"></script>

</body>
</html>